"use strict";(()=>{var e={};e.id=961,e.ids=[961],e.modules={1185:e=>{e.exports=require("mongoose")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},788:(e,t,i)=>{i.r(t),i.d(t,{headerHooks:()=>m,originalPathname:()=>y,patchFetch:()=>S,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>p,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>h});var r={};i.r(r),i.d(r,{GET:()=>l});var a=i(5419),n=i(9108),o=i(9678),s=i(8070),c=i(1525);async function l(){try{let e=await (0,c.t)();return s.Z.json(e)}catch(e){return console.error("Failed to fetch categories:",e),s.Z.json({error:"Failed to fetch categories"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/categories/route",pathname:"/api/categories",filename:"route",bundlePath:"app/api/categories/route"},resolvedPagePath:"/Users/failasbasheer/Downloads/alleppey-luxury-houseboats/app/api/categories/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:u,staticGenerationAsyncStorage:g,serverHooks:p,headerHooks:m,staticGenerationBailout:h}=d,y="/api/categories/route";function S(){return(0,o.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:g})}},1525:(e,t,i)=>{i.d(t,{f:()=>c,t:()=>s});var r=i(7033),a=i(6659),n=i(1452);let o=(e,t=0)=>{let i=e.toObject?e.toObject():e;return{id:i._id.toString(),slug:i.slug,title:i.display_name||i.name,tagline:i.tagline||"",description:i.description||"",shortDescription:i.secondaryDescription||i.description||"",guestCapacity:i.guestCapacity||"2 - 6 Guests",amenities:(i.amenitiesList||[]).map(e=>({icon:e.icon||"Star",title:e.title||"",description:e.desc||e.description||""})),stats:{totalBoats:t||i.stats?.totalBoats||0,rating:i.stats?.rating||4.8},heroImage:i.imagePlaceholder?i.imagePlaceholder.startsWith("http")||i.imagePlaceholder.startsWith("/packages")?i.imagePlaceholder:i.imagePlaceholder.startsWith("/uploads")?`http://localhost:5001${i.imagePlaceholder}`:`http://localhost:5001/uploads/category/${i.imagePlaceholder}`:`/packages/${i.slug}.webp`,testimonials:(i.reviews||[]).map((e,t)=>({id:t,text:e.text||"",author:e.name||"Guest",location:e.location||""})),whatsappTemplate:`Hi, I am interested in booking a ${i.display_name||i.name}.`}};async function s(){await (0,r.Z)();let e=await a.Z.find({is_active:!0}).lean(),t=await n.Z.aggregate([{$group:{_id:"$category_id",count:{$sum:1}}}]),i=new Map;t.forEach(e=>{e._id&&i.set(e._id.toString(),e.count)});let s=["deluxe","premium","luxury","romantic","shared-tours"];return e.sort((e,t)=>{let i=s.indexOf(e.slug),r=s.indexOf(t.slug);return(-1===i?999:i)-(-1===r?999:r)}),e.map(e=>{let t=i.get(e._id.toString())||0;return o(e,t)})}async function c(e){await (0,r.Z)();let t=await a.Z.findOne({slug:e,is_active:!0}).lean();if(!t)return null;let i=await n.Z.countDocuments({category_id:t._id});return o(t,i)}},7033:(e,t,i)=>{i.d(t,{Z:()=>s});var r=i(1185),a=i.n(r);let n=process.env.MONGO_URI;if(!n)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let o=global.mongoose;o||(o=global.mongoose={conn:null,promise:null});let s=async function(){if(o.conn)return o.conn;o.promise||(o.promise=a().connect(n,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}},6659:(e,t,i)=>{i.d(t,{Z:()=>o});var r=i(1185),a=i.n(r);let n=new r.Schema({slug:{type:String,required:!0,unique:!0},display_name:{type:String,required:!0},base_price:{type:Number,required:!0},is_active:{type:Boolean,default:!0},name:{type:String,required:!0},seoTitle:String,tagline:String,shortPitch:String,description:String,secondaryDescription:String,duration:String,guestCapacity:String,imagePlaceholder:String,amenitiesList:[r.Schema.Types.Mixed],audience:[String],badges:[String],bookingInfo:r.Schema.Types.Mixed,crew:r.Schema.Types.Mixed,deck:r.Schema.Types.Mixed,dining:r.Schema.Types.Mixed,faqs:[r.Schema.Types.Mixed],features:[String],gallery:[r.Schema.Types.Mixed],highlights:[String],journeyFlow:[r.Schema.Types.Mixed],pricing:r.Schema.Types.Mixed,reviews:[r.Schema.Types.Mixed],scenicRoutes:[r.Schema.Types.Mixed],startingPoint:r.Schema.Types.Mixed,stats:r.Schema.Types.Mixed,trustSignals:[String]},{timestamps:!0,strict:!1}),o=a().models?.Category||a().model("Category",n)},1452:(e,t,i)=>{i.d(t,{Z:()=>o});var r=i(1185),a=i.n(r);let n=new(a()).Schema({name:{type:String,required:!0},slug:{type:String,unique:!0,required:!0},category_id:{type:a().Schema.Types.ObjectId,ref:"Category",required:!0},status:{type:String,enum:["active","maintenance","decommissioned"],default:"active"},bedrooms:{type:Number,required:!0,default:1},capacity_adults:{type:Number,required:!0,default:2},capacity_children:{type:Number,default:0},has_ac:{type:Boolean,default:!0},cruise_hours:{type:Number,default:22},price_override:{type:Number},shared_package_availability:{type:Boolean,default:!1},images:{hero:{type:String,required:!0},exterior:String,interior:String,bedroom:String,dining:String,bathroom:String,extra1:String,extra2:String,extra3:String,gallery:[String]},notes:String,amenities:[{type:a().Schema.Types.ObjectId,ref:"Amenity"}],features:[{type:a().Schema.Types.ObjectId,ref:"Feature"}],tagline:String,shortPitch:String,description:String,secondaryDescription:String,badges:[String],crew:{size:{type:Number,default:3},roles:[String]},dining:{cuisineTypes:[String],isPrivate:{type:Boolean,default:!1},wineSommelier:Boolean},deck:{type:{type:String,default:"Upper Deck"},seating:String},journeyFlow:[String],scenicRoutes:[{name:String,duration:String,highlights:String}]},{timestamps:!0}),o=a().models.Houseboat||a().model("Houseboat",n)}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[638,206],()=>i(788));module.exports=r})();